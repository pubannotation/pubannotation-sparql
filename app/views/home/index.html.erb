<fieldset style="float:left">
	<legend>Search</legend>
	<form id="queryform" name="sparql" method="get" action="<%= @ep_url %>">
		<div>
			Default Graph IRI:<br/>
			<input id="graph" type="text" name="default-graph-uri" size="60" />
		</div>
		<br/>
		<div>
			SPARQL:
			<textarea id="query" name="query" maxlength="1200" required="required"><%= default_query -%></textarea>
		</div>
		<div style="margin:5px">
			<table class="center">
				<tr>
					<th>Show results by</th>
					<td>
						<table class="plain">
							<tr>
								<td>
									<input type="radio" name="actionsel" onclick="set_path_to_ep()" checked="checked"/><span title="It shows the list of bindings to the variables specified in the 'SELECT' clause">Virtuoso</span>
								</td>
							</tr>
							<tr>
								<td>
									<input type="radio" name="actionsel" onclick="set_path_to_textae()"/><span title="It shows the minimal spans containing the solutions.">TextAE</span>
								</td>
								<td>
									<label>with context size</label>:<input type="text" name="context_size" size="3" value="20" /><br/>
									<label>for edition</label>:<input type="checkbox" name="mode" value="edit" />
								</td>
							</tr>
						</table>
					</td>
				</tr>
			</table>
		</div>
		<input type="submit" name="submit" value="submit" style="height: 30px; width: 600px" />
	</form>
	<div id="comment">
		<%= default_comment.html_safe %>
	</div>
</fieldset>

<!-- codemirror scripts -->
<script>
	var sparqlMirror = CodeMirror.fromTextArea(document.getElementById("query"), {
		lineNumbers: true,
		mode: "sparql"
	});

	function set_path_to_ep() {
		document.getElementById('queryform').action = "<%= @ep_url %>"
	}

	function set_path_to_textae() {
		document.getElementById('queryform').action = "<%= @path_prefix %>/solutions/index"
	}

	function setquery(query) {
		document.getElementById("graph").value = query["graph"];
		sparqlMirror.getDoc().setValue(query["sparql"]);
		if (query["comment"] == null || query["comment"] == "") {query["comment"] = "No explanation."};
		document.getElementById("comment").innerHTML = query["comment"];
	}
</script>

<fieldset class="panel">
	<legend>Prefixes</legend>
<pre>
<%= @prefixes.map{|p| "PREFIX #{p[:prefix]}:<#{p[:uri]}>"}.join("\n") %>
</pre>
</fieldset>

<fieldset class="panel">
	<legend>Graphs</legend>
<pre>
<%= @graphs.map{|g| '<' + g + '>'}.join("\n") %>
</pre>
</fieldset>

<fieldset class="panel">
	<legend>Example queries</legend>
	<%= render :partial => "queries/list" %>
</fieldset>

<div style="clear:both"/>